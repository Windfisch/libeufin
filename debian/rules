#!/usr/bin/make -f
include /usr/share/dpkg/default.mk

export JAVA_HOME = /usr/lib/jvm/default-java
GROOVY_HOME      = /usr/share/groovy
DEV = -dev.2
FULLVER = $(DEB_VERSION_UPSTREAM)$(DEV)

clean:
	rm -rf libeufin-$(FULLVER)
build: build-arch build-indep
build-arch:
	true
build-indep:
	true
install:
	unzip build/distributions/libeufin-$(FULLVER).zip
	dh_install libeufin-$(FULLVER)/lib/nexus-$(FULLVER)-all.jar $(GROOVY_HOME)/lib
	dh_install libeufin-$(FULLVER)/lib/sandbox-$(FULLVER)-all.jar $(GROOVY_HOME)/lib
	install -D -m755 libeufin-$(FULLVER)/bin/libeufin-cli debian/libeufin/$(GROOVY_HOME)/bin/libeufin-cli
	install -D -m755 libeufin-$(FULLVER)/bin/libeufin-nexus debian/libeufin/$(GROOVY_HOME)/bin/libeufin-nexus
	install -D -m755 libeufin-$(FULLVER)/bin/libeufin-sandbox debian/libeufin/$(GROOVY_HOME)/bin/libeufin-sandbox
	dh_link $(GROOVY_HOME)/bin/libeufin-cli /usr/bin/libeufin-cli
	dh_link $(GROOVY_HOME)/bin/libeufin-nexus /usr/bin/libeufin-nexus
	dh_link $(GROOVY_HOME)/bin/libeufin-sandbox /usr/bin/libeufin-sandbox

binary:
	dh $@
binary-arch:
	dh $@
binary-indep:
	dh $@

override_dh_auto_install:
	true


get-orig-source:
	uscan --force-download --rename
